// This function is called when the Office JavaScript library is ready
Office.onReady(function (info) {
    if (info.host === Office.MailboxEnums.HostType.Outlook) {
        // Add a handler for the custom button click event
        document.getElementById("openMultipleEmailsButton").onclick = function () {
            // Get selected items
            Office.context.mailbox.getSelectedDataAsync(Office.MailboxEnums.ItemType.Message, function (result) {
                if (result.status === Office.AsyncResultStatus.Succeeded) {
                    var selectedEmails = result.value;

                    // Check if multiple emails are selected
                    if (selectedEmails.length > 1) {
                        // Show the task pane
                        Office.addin.showTaskpane({
                            taskpaneId: "yourTaskPaneId",
                            title: "Multiple Emails Task Pane",
                            url: "taskpane.html",
                            width: 350,
                            height: 400,
                        });
                    } else {
                        // Handle the case when only one email is selected or no emails are selected
                        // You can provide different behavior here if needed
                        console.log("Please select multiple emails to open the side pane.");
                    }
                } else {
                    // Handle the case when getting selected data fails
                    console.error("Error getting selected data: " + result.error.message);
                }
            });
        };
    }
});