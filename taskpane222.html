<!DOCTYPE html>
<html>
<head>
    <title>Outlook Add-in</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <div>
        <h1>Selected Email Subject Lines</h1>
        <ul id="subjectList"></ul>
    </div>

    <script>
        Office.onReady(function (info) {
            if (info.host === Office.MailboxEnums.HostType.Outlook) {
                // Define a function to update the subject lines in the side pane
                function updateSubjectLines() {
                    Office.context.mailbox.getSelectedDataAsync(Office.MailboxEnums.ItemType.Message, { propertyId: 'subject' }, function (result) {
                        if (result.status === Office.AsyncResultStatus.Succeeded) {
                            var subjectLines = result.value.map(function (item) {
                                return '<li>' + item.subject + '</li>';
                            });
                            document.getElementById('subjectList').innerHTML = subjectLines.join('');
                        }
                    });
                }

                // Add an event handler for the item selection changed event
                Office.context.mailbox.addHandlerAsync(Office.EventType.ItemSelectionChanged, updateSubjectLines);

                // Initially update the subject lines if emails are already selected
                updateSubjectLines();
            }
        });
    </script>
</body>
</html>

