<!DOCTYPE html>
<html>
<head>
    <title>Outlook Add-in</title>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
</head>
<body>
    <div>
        <h1>Selected Email Subject Lines!</h1>
        <ul id="subjectList"></ul>
    </div>

    <script>
        Office.onReady(function (info) {
            if (info.host === Office.MailboxEnums.HostType.Outlook) {
                // Define a function to handle the item selection change event
                function handleItemSelectionChanged(eventArgs) {
                    var selectedItems = eventArgs.getSnapshot();

                    // Check the number of selected items
                    if (selectedItems.length >= 2) {
                        // Multiple emails are selected, show the task pane
                        Office.addin.showTaskpane();
                    } else {
                        // Less than two emails are selected, close the task pane if it's open
                        Office.addin.closeTaskpane();
                    }
                }

                // Add an event handler for the item selection changed event
                Office.context.mailbox.addHandlerAsync(Office.EventType.ItemSelectionChanged, handleItemSelectionChanged);
            }
        });
    </script>
</body>
</html>

